<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Server Configuration - SecurityGuard</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Navigation -->
    <nav class="main-nav">
        <div class="nav-container">
            <div class="nav-brand">
                <div class="brand-icon">
                    <svg class="brand-svg" viewBox="0 0 32 32">
                        <defs>
                            <linearGradient id="brandGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" style="stop-color:#00E5FF"/>
                                <stop offset="100%" style="stop-color:#00B7EB"/>
                            </linearGradient>
                        </defs>
                        <path d="M16,2 L2,7 L2,23 L16,30 L30,23 L30,7 L16,2 Z M16,5 L26,9 L26,21 L16,27 L6,21 L6,9 L16,5 Z" fill="url(#brandGradient)"/>
                        <circle cx="16" cy="16" r="6" fill="url(#brandGradient)" opacity="0.3"/>
                        <circle cx="16" cy="16" r="3" fill="#FFFFFF"/>
                    </svg>
                </div>
                <span class="brand-text">SecurityGuard</span>
                <span class="brand-badge">PRO</span>
            </div>
            
            <div class="nav-actions">
                <button class="btn btn-back" onclick="goBack()">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="m12 19-7-7 7-7"/>
                        <path d="M19 12H5"/>
                    </svg>
                    Back
                </button>
                <button class="logout-btn" onclick="logout()" title="Logout">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                        <polyline points="16,17 21,12 16,7"></polyline>
                        <line x1="21" y1="12" x2="9" y2="12"></line>
                    </svg>
                </button>
            </div>
        </div>
    </nav>

    <!-- Loading State -->
    <div class="loading-container" id="loadingContainer">
        <div class="loading-spinner">
            <div class="spinner-ring"></div>
            <div class="spinner-ring"></div>
            <div class="spinner-ring"></div>
        </div>
        <h2 class="loading-title">Loading Configuration</h2>
        <p class="loading-description">Fetching server settings and roles...</p>
    </div>

    <!-- Error State -->
    <div class="error-container" id="errorContainer" style="display: none;">
        <div class="error-icon">
            <svg viewBox="0 0 24 24">
                <circle cx="12" cy="12" r="10" stroke="currentColor" fill="none" stroke-width="2"/>
                <line x1="15" y1="9" x2="9" y2="15" stroke="currentColor" stroke-width="2"/>
                <line x1="9" y1="9" x2="15" y2="15" stroke="currentColor" stroke-width="2"/>
            </svg>
        </div>
        <h2 class="error-title">Configuration Error</h2>
        <p class="error-description" id="errorDescription">Failed to load server configuration.</p>
        <button class="btn btn-primary" onclick="retryLoad()">
            <span>Retry</span>
        </button>
    </div>

    <!-- Main Content -->
    <main class="main-content" id="mainContent" style="display: none;">
        <!-- Server Header -->
        <div class="server-header">
            <div class="server-info">
                <div class="server-icon" id="serverIcon">
                    <span id="serverIconText"></span>
                </div>
                <div class="server-details">
                    <h1 class="server-name" id="serverName">Loading...</h1>
                    <p class="server-id">Server ID: <span id="serverId">Loading...</span></p>
                </div>
            </div>
            <div class="server-stats">
                <div class="stat-item">
                    <span class="stat-number" id="memberCount">-</span>
                    <span class="stat-label">Members</span>
                </div>
                <div class="stat-divider"></div>
                <div class="stat-item">
                    <span class="stat-number" id="roleCount">-</span>
                    <span class="stat-label">Roles</span>
                </div>
            </div>
        </div>

        <!-- Configuration Sections -->
        <div class="config-container">
            <!-- Link Protection Configuration -->
            <div class="config-section">
                <div class="section-header">
                    <div class="section-title">
                        <h2>üîó Link Protection</h2>
                        <p>Control and monitor links shared in your server</p>
                    </div>
                    <div class="section-toggle">
                        <label class="toggle-switch">
                            <input type="checkbox" id="linkProtectionEnabled">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>

                <div class="section-content" id="linkProtectionContent">
                    <!-- Whitelisted Domains -->
                    <div class="config-group">
                        <h3>üåê Whitelisted Domains</h3>
                        <p class="config-description">Domains that are always allowed (e.g., youtube.com, github.com)</p>
                        
                        <div class="input-group">
                            <input type="text" id="domainInput" placeholder="Enter domain (e.g., example.com)" class="config-input">
                            <button type="button" onclick="addWhitelistDomain()" class="btn btn-secondary">Add Domain</button>
                        </div>
                        
                        <div id="whitelistDomains" class="tag-list"></div>
                    </div>

                    <!-- Whitelisted Users -->
                    <div class="config-group">
                        <h3>üë• Whitelisted Users</h3>
                        <p class="config-description">Users who can send links freely</p>
                        
                        <div class="input-group">
                            <input type="text" id="userInput" placeholder="Enter User ID or @username" class="config-input">
                            <button type="button" onclick="addWhitelistUser()" class="btn btn-secondary">Add User</button>
                        </div>
                        
                        <div id="whitelistUsers" class="tag-list"></div>
                    </div>

                    <!-- Whitelisted Roles -->
                    <div class="config-group">
                        <h3>üé≠ Whitelisted Roles</h3>
                        <p class="config-description">Roles that can send links freely</p>
                        
                        <div class="input-group">
                            <select id="roleSelect" class="config-select">
                                <option value="">Loading roles...</option>
                            </select>
                            <button type="button" onclick="addWhitelistRole()" class="btn btn-secondary">Add Role</button>
                        </div>
                        
                        <div id="whitelistRoles" class="tag-list"></div>
                    </div>

                    <!-- Protection Settings -->
                    <div class="config-group">
                        <h3>‚öôÔ∏è Protection Settings</h3>
                        
                        <div class="config-option">
                            <label class="config-checkbox">
                                <input type="checkbox" id="blockSuspicious" checked>
                                <span class="checkmark"></span>
                                Block suspicious links automatically
                            </label>
                            <p class="config-help">Automatically block links that appear to be malicious or phishing attempts</p>
                        </div>

                        <div class="config-option">
                            <label class="config-checkbox">
                                <input type="checkbox" id="scanEmbeds" checked>
                                <span class="checkmark"></span>
                                Scan embedded content
                            </label>
                            <p class="config-help">Check links in embedded messages and rich content</p>
                        </div>

                        <div class="config-option">
                            <label class="config-checkbox">
                                <input type="checkbox" id="checkRedirects" checked>
                                <span class="checkmark"></span>
                                Check redirect links
                            </label>
                            <p class="config-help">Follow shortened URLs to check their final destination</p>
                        </div>

                        <div class="config-option">
                            <label class="config-checkbox">
                                <input type="checkbox" id="allowMediaLinks" checked>
                                <span class="checkmark"></span>
                                Allow media links
                            </label>
                            <p class="config-help">Allow direct links to images, videos, and audio files</p>
                        </div>
                    </div>

                    <!-- Punishment Settings -->
                    <div class="config-group">
                        <h3>‚öñÔ∏è Punishment Action</h3>
                        <p class="config-description">What happens when a non-whitelisted link is detected</p>
                        
                        <select id="punishmentAction" class="config-select">
                            <option value="delete">Delete Message</option>
                            <option value="delete_warn">Delete Message + Warn User</option>
                            <option value="timeout">Time Out User (5 minutes)</option>
                            <option value="kick">Kick User (Can't join for 1 hour)</option>
                            <option value="ban">Ban User</option>
                        </select>
                    </div>

                    <!-- Custom Warning Message -->
                    <div class="config-group">
                        <h3>üí¨ Custom Warning Message</h3>
                        <p class="config-description">Message shown when a link is blocked</p>
                        
                        <textarea id="warnMessage" class="config-textarea" placeholder="Links are not allowed in this server." rows="3"></textarea>
                    </div>

                    <!-- Save Button -->
                    <div class="config-actions">
                        <button onclick="saveLinkProtectionConfig()" class="btn btn-primary btn-large">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/>
                                <polyline points="17,21 17,13 7,13 7,21"/>
                                <polyline points="7,3 7,8 15,8"/>
                            </svg>
                            Save Configuration
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Notification Container -->
    <div id="notificationContainer" class="notification-container"></div>

    <script src="/config.js"></script>
    <script src="script.js"></script>
</body>
</html>
